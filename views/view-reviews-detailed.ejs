<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>View Reviews - Detailed</title>
  <!-- Include Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Include Bootstrap Icons (optional) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body>

<div class="container py-4">
    <!-- Page Title Section -->
    <div class="mb-5 text-center">
        <h1 class="display-4 text-primary">
        <i class="bi bi-journal-text me-2"></i> Detailed Reviews Page
        </h1>
        <p class="text-muted">Comprehensive breakdown of team reviews, scores, and feedback for each student.</p>
    </div>

  <!-- Dashboard Component -->
  <div class="mb-5">
    <h2 class="text-primary mb-4"><i class="bi bi-bar-chart-fill me-2"></i>Assessment Dashboard</h2>
    <div class="row g-4">
      <!-- Cooperation Score Card -->
      <div class="col-md-3">
        <div class="card text-center shadow-sm border-0 h-100">
          <div class="card-body">
            <h5 class="card-title">Cooperation</h5>
            <p class="display-6 text-success">88%</p> <!-- Replace with dynamic values if available -->
            <div class="progress mt-2">
              <div class="progress-bar bg-success" role="progressbar" style="width: 88%" aria-valuenow="88" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Conceptual Score Card -->
      <div class="col-md-3">
        <div class="card text-center shadow-sm border-0 h-100">
          <div class="card-body">
            <h5 class="card-title">Conceptual</h5>
            <p class="display-6 text-info">75%</p> <!-- Replace with dynamic values if available -->
            <div class="progress mt-2">
              <div class="progress-bar bg-info" role="progressbar" style="width: 75%" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Practical Score Card -->
      <div class="col-md-3">
        <div class="card text-center shadow-sm border-0 h-100">
          <div class="card-body">
            <h5 class="card-title">Practical</h5>
            <p class="display-6 text-warning">82%</p> <!-- Replace with dynamic values if available -->
            <div class="progress mt-2">
              <div class="progress-bar bg-warning" role="progressbar" style="width: 82%" aria-valuenow="82" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Work Ethic Score Card -->
      <div class="col-md-3">
        <div class="card text-center shadow-sm border-0 h-100">
          <div class="card-body">
            <h5 class="card-title">Work Ethic</h5>
            <p class="display-6 text-primary">90%</p> <!-- Replace with dynamic values if available -->
            <div class="progress mt-2">
              <div class="progress-bar bg-primary" role="progressbar" style="width: 90%" aria-valuenow="90" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content Section -->
  <% var studentArr; %>
  <% var isNewTeam = true; %>
  <% for(var i = 0, j = 0; i < student_info.length; i++) { %>
    <% if(isNewTeam) { isNewTeam = false; %>
      <!-- Team Header -->
      <div class="mb-4">
        <h3 class="text-primary border-bottom pb-2">
          <i class="bi bi-people-fill me-2"></i> Team Name: <%= groups[j].group_name %>
        </h3>
        <% studentArr = getTeammateInfo(student_info, sorted_students, i); %>
      </div>
    <% } %>
    <% if(groups[j].id_group != student_info[i].id_group) { j++; i--; isNewTeam = true; continue; } %>
    <% if(i > 0 && student_info[i].id == student_info[i - 1].id) { continue; } %>

    <!-- Student Details -->
    <div class="mb-3">
      <h4><b>Student Name: </b><%= student_info[i].name %></h4>
      <div class="table-responsive mb-3">
        <table class="table table-bordered table-striped table-hover">
          <thead class="table-dark">
            <tr>
              <th>Member</th>
              <th>Cooperation</th>
              <th>Conceptual</th>
              <th>Practical</th>
              <th>Work Ethic</th>
              <th>Average Across All</th>
            </tr>
          </thead>
          <tbody>
            <% for(var k = 0; k < studentArr.length; k++) { %>
              <% if(studentArr[k].id == student_info[i].id) { continue; } %>
              <% var info = getGradesGivenByStudent(student_info[i].id, studentArr[k].id, student_info); %>
              <tr>
                <td><%= studentArr[k].name %></td>
                <td><%= info.cooperation %></td>
                <td><%= info.conceptual_contribution %></td>
                <td><%= info.practical_contribution %></td>
                <td><%= info.work_ethic %></td>
                <td><%= (info.cooperation + info.conceptual_contribution + info.practical_contribution + info.work_ethic) / 4.0 %></td>
              </tr>
            <% } %>
          </tbody>
        </table>
      </div>

      <!-- Student Comments -->
      <% for(var k = 0; k < studentArr.length; k++) { %>
        <% if(studentArr[k].id == student_info[i].id) { continue; } %>
        <p><b><%= studentArr[k].name %> comment: </b></p>
        <p class="text-muted"><%- getCommentMadeByStudent(student_info[i].id, studentArr[k].id, student_info) %></p>
      <% } %>
    </div>
  <% } %>
</div>

<!-- Include Bootstrap JS (Optional, for tooltips, popovers, etc.) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
